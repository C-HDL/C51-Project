C51 COMPILER V9.01   IIC                                                                   01/13/2024 21:26:09 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE IIC
OBJECT MODULE PLACED IN .\Obj\iic.obj
COMPILER INVOKED BY: E:\keilc51\C51\BIN\C51.EXE APP\iic\iic.c BROWSE INCDIR(.\Public;.\APP\key;.\APP\smg;.\APP\iic;.\APP
                    -\at24c02) DEBUG OBJECTEXTEND PRINT(.\Obj\iic.lst) OBJECT(.\Obj\iic.obj)

line level    source

   1          #include "iic.h"
   2          
   3          void iic_start()
   4          {
   5   1              IIC_SCL=1;
   6   1              IIC_SDA=1;
   7   1              delay(1);
   8   1              IIC_SDA=0;
   9   1              delay(1);
  10   1              IIC_SCL=0;
  11   1      }
  12          
  13          
  14          void iic_stop()
  15          {
  16   1              IIC_SCL=1;
  17   1              IIC_SDA=0;
  18   1              delay(1);
  19   1              IIC_SDA=1;
  20   1              delay(1);
  21   1      }
  22          
  23          void iic_ack()
  24          {       IIC_SDA=0;
  25   1              IIC_SCL=0;
  26   1              delay(1);
  27   1              IIC_SCL=1;
  28   1              delay(1);
  29   1              IIC_SCL=0;
  30   1      }
  31          
  32          void iic_nack()
  33          {       IIC_SDA=1;
  34   1              IIC_SCL=0;
  35   1              delay(1);
  36   1              IIC_SCL=1;
  37   1              delay(1);
  38   1              IIC_SCL=0;
  39   1      }
  40          
  41          u8 iic_wait_ack()
  42          {       u8 temp=0;
  43   1              IIC_SCL=1;
  44   1              delay(1);
  45   1              while(IIC_SDA){
  46   2                      temp++;
  47   2                      if(temp>100)
  48   2                      {
  49   3                              iic_stop();
  50   3                              return 1;
  51   3                      }
  52   2      
  53   2              }
  54   1              IIC_SCL=0;
C51 COMPILER V9.01   IIC                                                                   01/13/2024 21:26:09 PAGE 2   

  55   1              return 0;               
  56   1      }
  57          
  58          
  59          void iic_write_byte(u8 dat){
  60   1              u8 i=0;
  61   1              IIC_SCL=0;
  62   1              for(i=0;i<8;i++){
  63   2                      if((dat&0x80)>0){
  64   3                              IIC_SDA=1;}
  65   2                      else
  66   2                              IIC_SDA=0;      
  67   2                              
  68   2                      dat<<=1;
  69   2                      delay(1);
  70   2                      IIC_SCL=1;
  71   2                      delay(1);
  72   2                      IIC_SCL=0;
  73   2                      delay(1);
  74   2                      }
  75   1       }
  76          
  77           u8 iic_read_byte(u8 ack){
  78   1              u8 i=0;
  79   1              u8 receive=0;
  80   1              for(i=0;i<8;i++){
  81   2                      IIC_SCL=0;
  82   2                      delay(1);
  83   2                      IIC_SCL=1;
  84   2                      
  85   2                      receive<<=1;
  86   2                      if(IIC_SDA){
  87   3                              receive++;
  88   3                              delay(1);}
  89   2                                      }
  90   1                      if(!ack) iic_nack();
  91   1                      else iic_ack();
  92   1                      
  93   1              return receive;
  94   1      }                               


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    250    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
